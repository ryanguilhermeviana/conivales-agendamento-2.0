<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=h1, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel="stylesheet">
</head>

<body class="main-margin main-grid">
    <section class="bk-gray">
        <nav class="menu-nav">
            <div class="menu-logo">
                <div class="menu-logo-img">
                    <img src="./img/logo_transp.png" alt="Logo do Conivales" class="menu-img">
                </div>
                <h1>CONIVALES</h1>
            </div>
            <div class="menu-menu">
                <ul>
                    <li><a href="index.html">Dashboard</a></li>
                    <li><a href="cadastrar_paciente.html">Cadastrar pacientes</a></li>
                    <!-- <li><a href="agendar_exames.html">Exames</a></li> -->
                    <li><a href="login.html">Logout</a></li>
                </ul>
            </div>
            <div class="menu-user">
                <!-- <img width="32" height="32" src="https://img.icons8.com/puffy-filled/32/user.png" alt="user" /> -->
                <div>
                    <img src="./img/user.svg" alt="" width="40" height="40" class="menu-user-border">
                </div>
                <h4>Ryan Guilherme</h4>
                <p>email@email.com</p>
            </div>
        </nav>
    </section>

    <section class="section-white dashboard">
        <div class="titulo-dashboard">
            <div>
                <h1>Dashboard</h1>
            </div>

            <div class="a a2">
                <p>Período</p>
                <select name="fperiodo" id="fperiodo" class="a3">
                    <option value="3">Últimos 3 meses</option>
                    <option value="6">Últimos 6 meses</option>
                    <option value="12">Últimos 12 meses</option>
                </select>
            </div>
        </div>
        <div class="b">
            <div class="b2 b3">
                <h3>Municípios</h3>
                <p>21</p>
            </div>

            <div class="b2 b3">
                <h3>Exames realizados</h3>
                <p>500</p>
            </div>

            <div class="b2 b3">
                <h3>Exames pendentes</h3>
                <p>50</p>
            </div>

            <div class="b2 b3">
                <h3>Valor total dos exames</h3>
                <p>R$ 2.598,84</p>
            </div>
            <div class="b2 b3">
                <h3>Valor total das taxas</h3>
                <p>R$ 500,64</p>
            </div>
        </div>

        <div class="c">
            <h3>Gráficos</h3>
            <div class="c2">
                <canvas id="myChart" style="height: 350px;"></canvas>
            </div>
        </div>

        <div class="d">
            <h3>Destaques</h3>
            <div class="d2">
                <div class="d3">
                    <h5>Exames mais solicitados</h5>
                    <hr>
                    <table class="e">
                        <tr class="e2">
                            <td>Nome</td>
                            <td>Quantidade</td>
                        </tr>
                        <tr class="e3">
                            <td>Radiografia de Coluna Cervical (ap + Lateral + TO + Obliquas)</td>
                            <td class="e4">62</td>
                        </tr>
                        <tr class="e3">
                            <td>Ultrassonografia de Articulação</td>
                            <td class="e4">57</td>
                        </tr>
                        <tr class="e3">
                            <td>Tomografia Computadorizada de Coluna Torácica</td>
                            <td class="e4">41</td>
                        </tr>
                        <tr class="e3">
                            <td>Ressonância Magnética de Tórax</td>
                            <td class="e4">34</td>
                        </tr>
                    </table>
                </div>
                <div class="d3">
                    <h5>Municípios que mais solicitaram exames</h5>
                    <hr>
                    <table class="e">
                        <tr class="e2">
                            <td>Nome</td>
                            <td>Quantidade</td>
                        </tr>
                        <tr class="e3">
                            <td>Radiografia de Coluna Cervical (ap + Lateral + TO + Obliquas)</td>
                            <td class="e4">62</td>
                        </tr>
                        <tr class="e3">
                            <td>Ultrassonografia de Articulação</td>
                            <td class="e4">57</td>
                        </tr>
                        <tr class="e3">
                            <td>Tomografia Computadorizada de Coluna Torácica</td>
                            <td class="e4">41</td>
                        </tr>
                        <tr class="e3">
                            <td>Ressonância Magnética de Tórax</td>
                            <td class="e4">34</td>
                        </tr>
                    </table>
                </div>
                <div class="d3">
                    <h5>Valor por município</h5>
                    <hr>
                    <table class="e">
                        <tr class="e2">
                            <td>Nome</td>
                            <td>Quantidade</td>
                        </tr>
                        <tr class="e3">
                            <td>Radiografia de Coluna Cervical (ap + Lateral + TO + Obliquas)</td>
                            <td class="e4">62</td>
                        </tr>
                        <tr class="e3">
                            <td>Ultrassonografia de Articulação</td>
                            <td class="e4">57</td>
                        </tr>
                        <tr class="e3">
                            <td>Tomografia Computadorizada de Coluna Torácica</td>
                            <td class="e4">41</td>
                        </tr>
                        <tr class="e3">
                            <td>Ressonância Magnética de Tórax</td>
                            <td class="e4">34</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Obter a URL atual
        const currentUrl = window.location.href;

        // Selecionar todos os itens de menu
        const menuItems = document.querySelectorAll('.menu-menu ul li a');

        menuItems.forEach(item => {
            // Verificar se o link do item corresponde à URL atual
            if (item.href === currentUrl) {
                // Adicionar a classe 'active' ao item pai (li)
                item.parentElement.classList.add('active');
            }
        });

        const ctx = document.getElementById('myChart').getContext('2d');

        const data = {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            datasets: [
                {
                    label: 'Radiografia',
                    data: [500, 700, 900, 600, 800, 400, 1000, 500, 700, 600, 900, 700],
                    backgroundColor: 'rgba(17, 141, 255, 1)',
                    borderColor: 'rgba(17, 141, 255, 1)',
                    borderWidth: 1
                },
                {
                    label: 'Ultrassonografia',
                    data: [300, 400, 600, 700, 500, 800, 900, 600, 500, 700, 600, 400],
                    backgroundColor: 'rgba(18, 35, 158, 1)',
                    borderColor: 'rgba(18, 35, 158, 1)',
                    borderWidth: 1
                },
                {
                    label: 'Ressonância',
                    data: [700, 500, 400, 900, 600, 700, 500, 400, 600, 500, 700, 600],
                    backgroundColor: 'rgba(230, 108, 55, 1)',
                    borderColor: 'rgba(230, 108, 55, 1)',
                    borderWidth: 1
                }
            ]
        };

        // Calculando a média de cada mês
        const monthlyAverage = data.datasets[0].data.map((_, i) => {
            const total = data.datasets.reduce((sum, dataset) => sum + dataset.data[i], 0);
            return total / data.datasets.length;
        });

        const chart = new Chart(ctx, {
            type: 'bar',
            data: data,
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 1000
                    }
                },
                plugins: {
                    annotation: {
                        annotations: {
                            line1: {
                                type: 'line',
                                yMin: monthlyAverage[0],
                                yMax: monthlyAverage[11],
                                borderColor: 'rgba(0, 0, 0, 1)',
                                borderWidth: 2,
                                label: {
                                    enabled: true,
                                    content: 'Média'
                                }
                            }
                        }
                    }
                }
            }
        });
    </script>

</body>

</html>